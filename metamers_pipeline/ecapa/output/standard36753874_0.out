Generating metamer for sound: /om2/user/amagaro/voice-speech-metamers/metamers_pipeline/kell2018/metamers/psychophysics_wsj400_jsintest_inversion_loss_layer_RS0_I3000_N8/0_SOUND_million/orig.wav
resampling audio
Loaded in ECAPA model
Generating metamer
  0%|          | 0/3000 [00:00<?, ?it/s]  0%|          | 0/3000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/net/vast-storage/scratch/vast/mcdermott/salavill/misc/voice-speech-metamers/metamers_pipeline/ecapa/make_ecapa_metamers.py", line 151, in <module>
    xadv = get_adv_examples(im_n_initialized)
  File "/net/vast-storage/scratch/vast/mcdermott/salavill/misc/voice-speech-metamers/metamers_pipeline/ecapa/make_ecapa_metamers.py", line 88, in get_adv_examples
    grad, = torch.autograd.grad(m * loss, [x])
  File "/home/salavill/.conda/envs/metamer310/lib/python3.10/site-packages/torch/autograd/__init__.py", line 411, in grad
    result = Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Trying to backward through the graph a second time (or directly access saved tensors after they have already been freed). Saved intermediate values of the graph are freed when you call .backward() or autograd.grad(). Specify retain_graph=True if you need to backward through the graph a second time or if you need to access saved tensors after calling backward.
